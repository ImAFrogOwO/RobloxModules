local Players = game:GetService("Players")

local Bans = game:GetService("DataStoreService"):GetDataStore("Bans")

Players.PlayerAdded:Connect(function(Player)
	
	local Data

	local Success , Error = pcall(function()

		Data = Bans:GetAsync(Player.UserId)

	end)

	if Data then
		
		if Data["Banned"] then
			
			Player:Kick("Banned")
			
		end
		
	else
		

		Bans:SetAsync(Player.UserId,
			{
				["Banned"] = false,
				["Reason"] = "No Data Yet."
			}
		)
		
	end

	Player.CharacterAdded:Connect(function(Character)

		--local Character = Player.Character

		task.spawn(function()

			while true do

				local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

				local FirstPos = HumanoidRootPart.Position

				wait(0.2)

				local LastPos = HumanoidRootPart.Position

				if (FirstPos - LastPos).Magnitude > 30 then

					HumanoidRootPart.Position = FirstPos

				end

			end

		end)

		task.spawn(function()

			while Character:FindFirstChild("Humanoid") do

				local Humanoid = Character:FindFirstChild("Humanoid")

				if Humanoid.HumanoidState == Enum.HumanoidStateType.PlatformStanding then

					Player:Kick("Flying")

					Bans:SetAsync(Player.UserId,
						{
							["Banned"] = true,
							["Reason"] = "Fly Exploiting (PERM BAN)"
						}
					)

				end

			end

		end)

	end)

end)
